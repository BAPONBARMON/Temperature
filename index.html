<input list="citySuggestions" id="cityInput" placeholder="Enter city name..." />
<datalist id="citySuggestions"></datalist>

<button onclick="getWeather()">Get Temperature</button>
<div id="loader"></div>
<div id="result"></div>

<script>
  let cityList = [];

  // Load all Assam city names from JSON
  fetch('cities.json')
    .then(res => res.json())
    .then(data => {
      cityList = data;
    });

  const input = document.getElementById('cityInput');
  const dataList = document.getElementById('citySuggestions');

  input.addEventListener('input', function () {
    const val = this.value.toLowerCase();
    dataList.innerHTML = '';

    const matches = cityList.filter(city =>
      city.toLowerCase().startsWith(val)
    );

    matches.forEach(city => {
      const option = document.createElement('option');
      option.value = city;
      dataList.appendChild(option);
    });
  });

  async function getWeather() {
    const city = input.value.trim();
    const result = document.getElementById('result');
    const loader = document.getElementById('loader');

    result.innerHTML = '';
    loader.innerHTML = '🔄 Loading...';

    try {
      const res = await fetch('https://temperature-backend.onrender.com/weather?city=' + encodeURIComponent(city));
      const data = await res.json();

      loader.innerHTML = '';
      if (data.error) {
        result.innerHTML = '❌ ' + data.error;
      } else {
        result.innerHTML = `🌡️ Temperature in <b>${data.city}</b> is <b>${data.temperature}°C</b>`;
      }
    } catch {
      loader.innerHTML = '';
      result.innerHTML = '⚠️ Error contacting server.';
    }
  }
</script>
